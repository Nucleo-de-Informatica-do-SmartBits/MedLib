{% extends 'bases/library.html' %}
{% load static %}
{% load compress %}
{% block title %}
Página Inicial
{% endblock title %}
{% block head %}
{% compress css %}
<link rel="stylesheet" href="{% static 'css/library/home.css' %}">
{% endcompress %}
{% endblock head %}
{% block content %}

<section class="relative w-full overflow-hidden" style="height: 240px;user-select: none;">
  <div class="w-full absolute inset-0 flex transition-transform duration-700 ease-in-out" id="image-slider">
    <img src="{% static 'imgs/slide1.jpeg' %}" alt="Image 1"
      class="flex-shrink-0 w-full h-full object-cover img transition-transform duration-500 hover:scale-105">
    <img src="{% static 'imgs/slide2.jpg' %}" alt="Image 2"
      class="flex-shrink-0 w-full h-full object-cover img transition-transform duration-500 hover:scale-105">
    <img src="{% static 'imgs/slide3.jpg' %}" alt="Image 3"
      class="flex-shrink-0 w-full h-full object-cover img transition-transform duration-500 hover:scale-105">
  </div>

  <div class="absolute inset-0 bg-black opacity-50"></div>

  <div class="absolute inset-0 flex items-center justify-center text-white text-4xl font-bold p-4">
    <span id="text" style="cursor: text;">"A leitura é a chave para abrir portas para o mundo do conhecimento e da
      imaginação."</span>
  </div>
</section>

<section class="books" style="margin-top: 5px;">
  <section class="sec1">
    {% for book in books %}
    <div class="card-book" data-api-url="{% url 'books-get-data' slug=book.slug %}" style="cursor: pointer;">
      <div class="sec-image" title="Abir o livro">
        <img src="{{book.cover.url}}" alt="Book Cover" class="imgsec">
      </div>
      <div class="sec-info">
        <h3 class="book-title">{{book.title|truncatechars:20}}</h3>
      </div>
    </div>

    <div class="modal" id="modal">

      <div class="modal-content">
        <div class="modal-header">
          <button class="close-btn" onclick="closeModal('modal')">X</button>
        </div>
        <hr>

        <div class="modal-body">
          <div class="modal-body-img">
            <img id="book-cover-modal" alt="Book Cover" class="imgsec">
          </div>
          <br>
          <div class="modal-body-details">

          </div>
        </div>
      </div>

    </div>
    {% endfor %}
  </section>
</section>

<div id="bookModal" class="modal" style="z-index: 3000;">
  <div class="modal-content"
    style="border-radius: 10px; padding: 20px; background-color: #fff; width: 600px; max-width: 100%; margin: auto;">

    <span class="close-btn"
      style="position: absolute; top: 10px; right: 15px; font-size: 24px; font-weight: bold; cursor: pointer;">&times;</span>
    <div style="display: flex; flex-direction: row; gap: 10px;margin-top: 30px;">
      <div id="img-div"
        style="flex: 1; height: 300px; display: flex; justify-content: center; align-items: center; background-color: rgba(203, 202, 202, 0.301); border-radius: 10px;">
        <img src="" alt="" id="book-cover-modal"
          style="max-height: 100%; max-width: 100%; object-fit: cover; border-radius: 10px;">
      </div>

      <div style="flex: 2; display: flex; flex-direction: column; justify-content: space-between;">
        <div>
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2 id="modalTitle" style="font-size: 24px; font-weight: bold;">O Velho e o Mar</h2>
            <button
              style="background-color: #3DB1C8; color: white; border: none; border-radius: 5px; padding: 8px 15px; cursor: pointer;">Ler</button>
          </div>
          <p style="font-size: 14px; color: #666; margin: 5px 0;">Por <span id="modalAuthors"
              style="color: #3EB3CA; text-decoration: underline; cursor: pointer;">Ernest Hemingway</span></p>
          <hr>
          <p id="modalDescription" style="font-size: 14px; color: #444; text-align: justify; line-height: 1.5;">Cuba,
            início dos anos 1950. Santiago, o pequeno rapaz, continua a acreditar nele apesar dos obstáculos.</p>
        </div>
      </div>
    </div>

    <!-- Rodapé com ícones -->
    <div style="margin-top: 20px; display: flex; justify-content: center; gap: 15px;">
      <div style="width: 40px; height: 40px; background-color: rgba(0, 0, 0, 0.1); border-radius: 50%;"></div>
      <div style="width: 40px; height: 40px; background-color: rgba(0, 0, 0, 0.1); border-radius: 50%;"></div>
      <div style="width: 40px; height: 40px; background-color: rgba(0, 0, 0, 0.1); border-radius: 50%;"></div>
      <div style="width: 40px; height: 40px; background-color: rgba(0, 0, 0, 0.1); border-radius: 50%;"></div>
    </div>


  </div>
</div>


{% compress js %}
<script>
  async function get_book_data(url) {
    const api = await fetch(url);
    return api.json();
  }

  document.querySelectorAll('.card-book')
    .forEach(card => {
      card.addEventListener('click', async () => {
        const data = await get_book_data(card.dataset.apiUrl);
        console.log(data)

        document.getElementById('book-cover-modal').setAttribute('src', data.cover)
        document.getElementById('modalTitle').textContent = data.title;
        document.getElementById('modalDescription').textContent = data.summary;
        // document.getElementById('modalPages').textContent = data.pages;
        // document.getElementById('modalLanguage').textContent = data.language;
        // document.getElementById('modalIsbn').textContent = data.isbn;
        // document.getElementById('modalEdition').textContent = `${data.edition}ª Edição`;
        // document.getElementById('modalPublisher').textContent = data.publisher;
        // document.getElementById('modalCategories').textContent = data.categories.join(', ');
        // document.getElementById('modalAuthors').textContent = data.authors.join(', ');
        // document.getElementById('modalPublicationDate').textContent = data.publication_date;
        // document.getElementById('read-link').setAttribute('href', data.read_link)

        const modal = document.getElementById('bookModal');
        modal.style.display = "flex";
      });
    });

  document.querySelector('.close-btn').addEventListener('click', () => {
    const modal = document.getElementById('bookModal');
    modal.style.display = "none";
  });

  window.addEventListener('click', (event) => {
    const modal = document.getElementById('bookModal');
    if (event.target === modal) {
      modal.style.display = "none";
    }
  });
</script>
<script src="{% static 'js/library/home.js' %}"></script>
{% endcompress %}
{% endblock content %}