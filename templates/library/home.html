{% extends 'bases/library.html' %}

{% load static %}
{% load compress %}

{% block title %}
Página Inicial
{% endblock title %}

{% block head %}

{% compress css %}
<link rel="stylesheet" href="{% static 'css/library/home.css' %}">
{% endcompress %}

{% endblock head %}

{% block content %}

<section class="relative w-full overflow-hidden" style="height: 240px;user-select: none;">
  <div class="w-full absolute inset-0 flex transition-transform duration-700 ease-in-out" id="image-slider">
    <img src="{% static 'imgs/slide1.jpeg' %}" alt="Image 1"
      class="flex-shrink-0 w-full h-full object-cover img transition-transform duration-500 hover:scale-105">
    <img src="{% static 'imgs/slide2.jpg' %}" alt="Image 2"
      class="flex-shrink-0 w-full h-full object-cover img transition-transform duration-500 hover:scale-105">
    <img src="{% static 'imgs/slide3.jpg' %}" alt="Image 3"
      class="flex-shrink-0 w-full h-full object-cover img transition-transform duration-500 hover:scale-105">
  </div>

  <div class="absolute inset-0 bg-black opacity-50"></div>

  <div class="absolute inset-0 flex items-center justify-center text-white text-4xl font-bold p-4">
    <span id="text" style="cursor: text;">"A leitura é a chave para abrir portas para o mundo do conhecimento e da
      imaginação."</span>
  </div>
</section>

<section class="books" style="margin-top: 5px;">
  <section class="sec1">

    {% for book in books %}
    <div class="card-book" data-api-url="{% url 'get_book_data' slug=book.slug %}">
      <div class="sec-image">
        <img src="{{ book.cover.url }}" alt="Book Cover" class="imgsec">
      </div>
      <div class="sec-info">
        <h3 class="book-title">{{ book.title }}</h3>
      </div>
    </div>
    {% endfor %}
  </section>
</section>


<!-- Modal -->
<div id="bookModal" class="modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h2 id="modalTitle"></h2>
    <p id="modalDescription"></p>
  </div>
</div>

{% compress js %}

<script>
  async function get_book_data(url) {
    const api = await fetch(url);
    return api.json();
  }

  document.querySelectorAll('.card-book')
    .forEach(card => {
      card.addEventListener('click', async () => {
        const data = await get_book_data(card.dataset.apiUrl); // Obtém os dados da API

        // Preenche o conteúdo do modal com os dados
        document.getElementById('modalTitle').textContent = data.title; // Exemplo: Título do livro
        document.getElementById('modalDescription').textContent = data.description; // Exemplo: Descrição do livro

        // Exibe o modal
        const modal = document.getElementById('bookModal');
        modal.style.display = "block";
      });
    });

  document.querySelector('.close-btn').addEventListener('click', () => {
    const modal = document.getElementById('bookModal');
    modal.style.display = "none";
  });

  window.addEventListener('click', (event) => {
    const modal = document.getElementById('bookModal');
    if (event.target === modal) {
      modal.style.display = "none";
    }
  });

</script>

<script src="{% static 'js/library/home.js' %}"></script>
{% endcompress %}

{% endblock content %}